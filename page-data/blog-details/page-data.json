{"componentChunkName":"component---src-pages-blog-details-js","path":"/blog-details/","result":{"data":{"markdownRemark":{"html":"<h1>Mutate object or arrays without changing original source in javascript</h1>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 1000px; \"\n    >\n      <a\n    class=\"gatsby-resp-image-link\"\n    href=\"/reach2kishore.com/static/acbc812ecee0d74dc6ac6a5d87032666/0f98f/banner.jpg\"\n    style=\"display: block\"\n    target=\"_blank\"\n    rel=\"noopener\"\n  >\n    <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 66.8%; position: relative; bottom: 0; left: 0; background-image: url('data:image/jpeg;base64,/9j/2wBDABALDA4MChAODQ4SERATGCgaGBYWGDEjJR0oOjM9PDkzODdASFxOQERXRTc4UG1RV19iZ2hnPk1xeXBkeFxlZ2P/2wBDARESEhgVGC8aGi9jQjhCY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2P/wgARCAANABQDASIAAhEBAxEB/8QAFwABAAMAAAAAAAAAAAAAAAAAAAIDBf/EABUBAQEAAAAAAAAAAAAAAAAAAAEA/9oADAMBAAIQAxAAAAHOUBgI/8QAGRAAAwEBAQAAAAAAAAAAAAAAAQIDABAS/9oACAEBAAEFApyDGs1XHBzvXP/EABQRAQAAAAAAAAAAAAAAAAAAABD/2gAIAQMBAT8BP//EABQRAQAAAAAAAAAAAAAAAAAAABD/2gAIAQIBAT8BP//EABsQAAEEAwAAAAAAAAAAAAAAABAAAQIRISIx/9oACAEBAAY/AsvS1lY6f//EABoQAQEBAQADAAAAAAAAAAAAAAEAESExQZH/2gAIAQEAAT8hwOI95KnC/YYweEU3m//aAAwDAQACAAMAAAAQJ/8A/8QAFhEAAwAAAAAAAAAAAAAAAAAAARAR/9oACAEDAQE/EKF//8QAFREBAQAAAAAAAAAAAAAAAAAAECH/2gAIAQIBAT8Qp//EABoQAQEBAQEBAQAAAAAAAAAAAAERACExgeH/2gAIAQEAAT8QXHJVJ+EyZ4aRB+YYdwagH2MuK63PVfd//9k='); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"rctx-contextmenu\"\n        title=\"Photo by Luca Micheli on Unsplash\"\n        src=\"/reach2kishore.com/static/acbc812ecee0d74dc6ac6a5d87032666/a2510/banner.jpg\"\n        srcset=\"/reach2kishore.com/static/acbc812ecee0d74dc6ac6a5d87032666/0479a/banner.jpg 250w,\n/reach2kishore.com/static/acbc812ecee0d74dc6ac6a5d87032666/41099/banner.jpg 500w,\n/reach2kishore.com/static/acbc812ecee0d74dc6ac6a5d87032666/a2510/banner.jpg 1000w,\n/reach2kishore.com/static/acbc812ecee0d74dc6ac6a5d87032666/c58a3/banner.jpg 1500w,\n/reach2kishore.com/static/acbc812ecee0d74dc6ac6a5d87032666/0f98f/banner.jpg 1920w\"\n        sizes=\"(max-width: 1000px) 100vw, 1000px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n      />\n  </a>\n    </span>\n<em>Photo by Luca Micheli on Unsplash</em></p>\n<p>If you are building javascript application irrespective of any framework, you would have faced a specific issue where you want to modify an <code class=\"language-text\">Object</code> or <code class=\"language-text\">Array</code>, but with modification, the original value also updating, but you don't want to update the original value.</p>\n<p>That's where an immutability helpers libraries help us. I personally prefer <a href=\"https://github.com/kolodny/immutability-helper\">Immutability Helper</a> library to handle this but there are others like <a href=\"https://github.com/kolodny/immutability-helper\">Immutable JS</a>, which is also a great library.</p>\n<p>In this post, I will be discussing the <a href=\"https://github.com/kolodny/immutability-helper\">Immutability Helper</a> library and will try to cover most of the features like push, splice, merge, etc.</p>\n<h2>Prerequisites</h2>\n<p>Before starting I would like you to go through <a href=\"https://developer.mozilla.org/en-US/docs/Web/JavaScript/Data_structures\">MDN</a> specification regarding data types and data structures which will give you a fair idea on various kinds of data types and data structures in JS.</p>\n<h2>The problem</h2>\n<div class=\"gatsby-highlight\" data-language=\"js\"><pre class=\"language-js\"><code class=\"language-js\"><span class=\"token keyword\">const</span> originalObj <span class=\"token operator\">=</span> <span class=\"token punctuation\">{</span>\n  name<span class=\"token operator\">:</span> <span class=\"token string\">'Volkswagen'</span><span class=\"token punctuation\">,</span>\n  color<span class=\"token operator\">:</span> <span class=\"token string\">'red'</span>\n<span class=\"token punctuation\">}</span>\n\n<span class=\"token keyword\">const</span> newObj <span class=\"token operator\">=</span> originalObj<span class=\"token punctuation\">;</span>\n\nnewObj<span class=\"token punctuation\">.</span>color <span class=\"token operator\">=</span> <span class=\"token string\">'green'</span><span class=\"token punctuation\">;</span>\n\nconsole<span class=\"token punctuation\">.</span><span class=\"token function\">log</span><span class=\"token punctuation\">(</span>newObj<span class=\"token punctuation\">.</span>color<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span> <span class=\"token comment\">// green</span>\nconsole<span class=\"token punctuation\">.</span><span class=\"token function\">log</span><span class=\"token punctuation\">(</span>originalObj<span class=\"token punctuation\">.</span>color<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span> <span class=\"token comment\">// green</span></code></pre></div>\n<p>The above example looks strange because I have changed <code class=\"language-text\">newObj</code> color value but <code class=\"language-text\">originalObj</code> color value also got the changes. This weird thing is happening because in Javascript <code class=\"language-text\">Object</code> and <code class=\"language-text\">Array</code> are reference types, that means if you are creating an object or array in one place and then assigning that value to another variable it takes only one memory allocation. So if you are changing any property value of <code class=\"language-text\">newObj</code> which has a reference value of  <code class=\"language-text\">originalObj</code>, that means you are changing in only one place. This happens the same for <code class=\"language-text\">Arrays</code> as well.</p>\n<p>More on this you can find <a href=\"https://www.javascripttutorial.net/javascript-primitive-vs-reference-values/\">here</a>.</p>\n<hr>\n<p>Now coming to our main focus are which is how to make object or arrays immutable using <a href=\"https://github.com/kolodny/immutability-helper\">Immutability Helper</a> library.</p>\n<p>To use <a href=\"https://github.com/kolodny/immutability-helper\">Immutability Helper</a> you have to first install it by running the below command</p>\n<div class=\"gatsby-highlight\" data-language=\"text\"><pre class=\"language-text\"><code class=\"language-text\">npm install immutability-helper --save</code></pre></div>\n<p>and import it wherever you want to use</p>\n<div class=\"gatsby-highlight\" data-language=\"js\"><pre class=\"language-js\"><code class=\"language-js\"><span class=\"token keyword\">import</span> update <span class=\"token keyword\">from</span> <span class=\"token string\">'immutability-helper'</span><span class=\"token punctuation\">;</span></code></pre></div>\n<p>Below are some of the <a href=\"https://github.com/kolodny/immutability-helper#update\">commands</a> which we can use</p>\n<h3>$push</h3>\n<p><code class=\"language-text\">push()</code> all the items in <code class=\"language-text\">array</code> on the target</p>\n<p>Example:</p>\n<div class=\"gatsby-highlight\" data-language=\"js\"><pre class=\"language-js\"><code class=\"language-js\"><span class=\"token keyword\">const</span> initialArray <span class=\"token operator\">=</span> <span class=\"token punctuation\">[</span><span class=\"token number\">1</span><span class=\"token punctuation\">,</span> <span class=\"token number\">2</span><span class=\"token punctuation\">,</span> <span class=\"token number\">3</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">;</span>\n<span class=\"token keyword\">const</span> newArray <span class=\"token operator\">=</span> <span class=\"token function\">update</span><span class=\"token punctuation\">(</span>initialArray<span class=\"token punctuation\">,</span> <span class=\"token punctuation\">{</span>$push<span class=\"token operator\">:</span> <span class=\"token punctuation\">[</span><span class=\"token number\">4</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\nconsole<span class=\"token punctuation\">.</span><span class=\"token function\">log</span><span class=\"token punctuation\">(</span>initialArray<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span> <span class=\"token comment\">// [ 1, 2, 3 ]</span>\nconsole<span class=\"token punctuation\">.</span><span class=\"token function\">log</span><span class=\"token punctuation\">(</span>newArray<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span> <span class=\"token comment\">// [ 1, 2, 3, 4 ]</span></code></pre></div>\n<h3>$splice</h3>\n<p>For each item in arrays call splice() on the target with the parameters provided by the item</p>\n<p>Nested array push example:</p>\n<div class=\"gatsby-highlight\" data-language=\"js\"><pre class=\"language-js\"><code class=\"language-js\"><span class=\"token keyword\">const</span> collection <span class=\"token operator\">=</span> <span class=\"token punctuation\">[</span><span class=\"token number\">1</span><span class=\"token punctuation\">,</span> <span class=\"token number\">2</span><span class=\"token punctuation\">,</span> <span class=\"token punctuation\">{</span>a<span class=\"token operator\">:</span> <span class=\"token punctuation\">[</span><span class=\"token number\">12</span><span class=\"token punctuation\">,</span> <span class=\"token number\">17</span><span class=\"token punctuation\">,</span> <span class=\"token number\">15</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">}</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">;</span>\n<span class=\"token keyword\">const</span> newCollection <span class=\"token operator\">=</span> <span class=\"token function\">update</span><span class=\"token punctuation\">(</span>collection<span class=\"token punctuation\">,</span> <span class=\"token punctuation\">{</span><span class=\"token number\">2</span><span class=\"token operator\">:</span> <span class=\"token punctuation\">{</span>a<span class=\"token operator\">:</span> <span class=\"token punctuation\">{</span>$splice<span class=\"token operator\">:</span> <span class=\"token punctuation\">[</span><span class=\"token punctuation\">[</span><span class=\"token number\">1</span><span class=\"token punctuation\">,</span> <span class=\"token number\">1</span><span class=\"token punctuation\">,</span> <span class=\"token number\">13</span><span class=\"token punctuation\">,</span> <span class=\"token number\">14</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">}</span><span class=\"token punctuation\">}</span><span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\nconsole<span class=\"token punctuation\">.</span><span class=\"token function\">log</span><span class=\"token punctuation\">(</span>collection<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span> <span class=\"token comment\">// [ 1, 2, { a: [ 12, 17, 15 ] } ]</span>\nconsole<span class=\"token punctuation\">.</span><span class=\"token function\">log</span><span class=\"token punctuation\">(</span>newCollection<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span> <span class=\"token comment\">// [ 1, 2, { a: [ 12, 13, 14, 15 ] } ]</span></code></pre></div>\n<p>Remove array element example:</p>\n<div class=\"gatsby-highlight\" data-language=\"js\"><pre class=\"language-js\"><code class=\"language-js\"><span class=\"token keyword\">const</span> obj <span class=\"token operator\">=</span> <span class=\"token punctuation\">{</span>items<span class=\"token operator\">:</span> <span class=\"token punctuation\">[</span><span class=\"token number\">1</span><span class=\"token punctuation\">,</span> <span class=\"token number\">2</span><span class=\"token punctuation\">,</span> <span class=\"token number\">3</span><span class=\"token punctuation\">,</span> <span class=\"token number\">4</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">}</span><span class=\"token punctuation\">;</span>\n<span class=\"token keyword\">const</span> index <span class=\"token operator\">=</span> <span class=\"token number\">2</span><span class=\"token punctuation\">;</span>\n<span class=\"token keyword\">const</span> newObj <span class=\"token operator\">=</span> <span class=\"token function\">update</span><span class=\"token punctuation\">(</span>obj<span class=\"token punctuation\">,</span> <span class=\"token punctuation\">{</span> items<span class=\"token operator\">:</span> <span class=\"token punctuation\">{</span> $splice<span class=\"token operator\">:</span> <span class=\"token punctuation\">[</span><span class=\"token punctuation\">[</span>index<span class=\"token punctuation\">,</span> <span class=\"token number\">1</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">]</span> <span class=\"token punctuation\">}</span> <span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\nconsole<span class=\"token punctuation\">.</span><span class=\"token function\">log</span><span class=\"token punctuation\">(</span>obj<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span> <span class=\"token comment\">// { items: [ 1, 2, 3, 4 ] }</span>\nconsole<span class=\"token punctuation\">.</span><span class=\"token function\">log</span><span class=\"token punctuation\">(</span>newObj<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span> <span class=\"token comment\">// { items: [ 1, 2, 4 ] }</span></code></pre></div>\n<h3>$apply</h3>\n<p>Passes in the current value to the function and updates it with the new returned value</p>\n<div class=\"gatsby-highlight\" data-language=\"js\"><pre class=\"language-js\"><code class=\"language-js\"><span class=\"token keyword\">const</span> obj <span class=\"token operator\">=</span> <span class=\"token punctuation\">{</span>a<span class=\"token operator\">:</span> <span class=\"token number\">5</span><span class=\"token punctuation\">,</span> b<span class=\"token operator\">:</span> <span class=\"token number\">3</span><span class=\"token punctuation\">}</span><span class=\"token punctuation\">;</span>\n<span class=\"token keyword\">const</span> newObj <span class=\"token operator\">=</span> <span class=\"token function\">update</span><span class=\"token punctuation\">(</span>obj<span class=\"token punctuation\">,</span> <span class=\"token punctuation\">{</span>b<span class=\"token operator\">:</span> <span class=\"token punctuation\">{</span><span class=\"token function-variable function\">$apply</span><span class=\"token operator\">:</span> <span class=\"token keyword\">function</span><span class=\"token punctuation\">(</span><span class=\"token parameter\">x</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span><span class=\"token keyword\">return</span> x <span class=\"token operator\">*</span> <span class=\"token number\">2</span><span class=\"token punctuation\">;</span><span class=\"token punctuation\">}</span><span class=\"token punctuation\">}</span><span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\nconsole<span class=\"token punctuation\">.</span><span class=\"token function\">log</span><span class=\"token punctuation\">(</span>obj<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span> <span class=\"token comment\">// { a: 5, b: 3 }</span>\nconsole<span class=\"token punctuation\">.</span><span class=\"token function\">log</span><span class=\"token punctuation\">(</span>newObj<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span> <span class=\"token comment\">// { a: 5, b: 6 }</span></code></pre></div>\n<h3>$set</h3>\n<p>Replace the target entirely</p>\n<p>Simple example:</p>\n<div class=\"gatsby-highlight\" data-language=\"js\"><pre class=\"language-js\"><code class=\"language-js\"><span class=\"token keyword\">const</span> obj <span class=\"token operator\">=</span> <span class=\"token punctuation\">{</span>a<span class=\"token operator\">:</span> <span class=\"token number\">5</span><span class=\"token punctuation\">,</span> b<span class=\"token operator\">:</span> <span class=\"token number\">3</span><span class=\"token punctuation\">}</span><span class=\"token punctuation\">;</span>\n<span class=\"token keyword\">const</span> newObj <span class=\"token operator\">=</span> <span class=\"token function\">update</span><span class=\"token punctuation\">(</span>obj<span class=\"token punctuation\">,</span> <span class=\"token punctuation\">{</span>b<span class=\"token operator\">:</span> <span class=\"token punctuation\">{</span>$set<span class=\"token operator\">:</span> obj<span class=\"token punctuation\">.</span>b <span class=\"token operator\">*</span> <span class=\"token number\">2</span><span class=\"token punctuation\">}</span><span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\nconsole<span class=\"token punctuation\">.</span><span class=\"token function\">log</span><span class=\"token punctuation\">(</span>obj<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span> <span class=\"token comment\">// { a: 5, b: 3 }</span>\nconsole<span class=\"token punctuation\">.</span><span class=\"token function\">log</span><span class=\"token punctuation\">(</span>newObj<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span> <span class=\"token comment\">// { a: 5, b: 6 }</span></code></pre></div>\n<p>Example with <a href=\"https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Operators/Object_initializer#Computed_property_names\">computed property names</a>:</p>\n<div class=\"gatsby-highlight\" data-language=\"js\"><pre class=\"language-js\"><code class=\"language-js\"><span class=\"token keyword\">const</span> collection <span class=\"token operator\">=</span> <span class=\"token punctuation\">{</span>children<span class=\"token operator\">:</span> <span class=\"token punctuation\">[</span><span class=\"token string\">'zero'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'one'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'two'</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">}</span><span class=\"token punctuation\">;</span>\n<span class=\"token keyword\">const</span> index <span class=\"token operator\">=</span> <span class=\"token number\">1</span><span class=\"token punctuation\">;</span>\n<span class=\"token keyword\">const</span> newCollection <span class=\"token operator\">=</span> <span class=\"token function\">update</span><span class=\"token punctuation\">(</span>collection<span class=\"token punctuation\">,</span> <span class=\"token punctuation\">{</span>children<span class=\"token operator\">:</span> <span class=\"token punctuation\">{</span><span class=\"token punctuation\">[</span>index<span class=\"token punctuation\">]</span><span class=\"token operator\">:</span> <span class=\"token punctuation\">{</span>$set<span class=\"token operator\">:</span> <span class=\"token number\">1</span><span class=\"token punctuation\">}</span><span class=\"token punctuation\">}</span><span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\nconsole<span class=\"token punctuation\">.</span><span class=\"token function\">log</span><span class=\"token punctuation\">(</span>collection<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span> <span class=\"token comment\">// { children: [ 'zero', 'one', 'two' ] }</span>\nconsole<span class=\"token punctuation\">.</span><span class=\"token function\">log</span><span class=\"token punctuation\">(</span>newCollection<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span> <span class=\"token comment\">// { children: [ 'zero', 1, 'two' ] }</span></code></pre></div>\n<h3>$merge</h3>\n<p>Merge the keys of an object with the target</p>\n<div class=\"gatsby-highlight\" data-language=\"js\"><pre class=\"language-js\"><code class=\"language-js\"><span class=\"token keyword\">const</span> obj <span class=\"token operator\">=</span> <span class=\"token punctuation\">{</span>a<span class=\"token operator\">:</span> <span class=\"token number\">5</span><span class=\"token punctuation\">,</span> b<span class=\"token operator\">:</span> <span class=\"token number\">3</span><span class=\"token punctuation\">}</span><span class=\"token punctuation\">;</span>\n<span class=\"token keyword\">const</span> newObj <span class=\"token operator\">=</span> <span class=\"token function\">update</span><span class=\"token punctuation\">(</span>obj<span class=\"token punctuation\">,</span> <span class=\"token punctuation\">{</span>$merge<span class=\"token operator\">:</span> <span class=\"token punctuation\">{</span>b<span class=\"token operator\">:</span> <span class=\"token number\">6</span><span class=\"token punctuation\">,</span> c<span class=\"token operator\">:</span> <span class=\"token number\">7</span><span class=\"token punctuation\">}</span><span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\nconsole<span class=\"token punctuation\">.</span><span class=\"token function\">log</span><span class=\"token punctuation\">(</span>obj<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span> <span class=\"token comment\">// { a: 5, b: 3 }</span>\nconsole<span class=\"token punctuation\">.</span><span class=\"token function\">log</span><span class=\"token punctuation\">(</span>newObj<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span> <span class=\"token comment\">// { a: 5, b: 6, c: 7 }</span></code></pre></div>\n<p>There are other 2 advanced features. One is <a href=\"https://github.com/kolodny/immutability-helper#autovivification\">Autovivification</a> and another one is <a href=\"https://github.com/kolodny/immutability-helper#adding-your-own-commands\">Adding your own commands</a>. You can check out those from their respective docs.</p>\n<h2>Conclusion</h2>\n<p>There are other libraries that solve immutability in a great way. I personally know about <a href=\"https://immutable-js.github.io/immutable-js/\">immutable-js</a>, which is great in its own way. You can try both and find which suits your project best. I personally used <a href=\"https://immutable-js.github.io/immutable-js/\">Immutability Helper</a> multiple times and thus I'm comfortable with this library. You can try whatever you want.</p>\n<p>Thanks for reading!</p>\n<p>Let me know what your thought on this post by messaging me on <a href=\"https://twitter.com/reachtokish\">twitter</a> or <a href=\"https://www.linkedin.com/in/reachtokish/\">linkedin</a>.</p>","frontmatter":{"date":"May 17, 2020","slug":"/blog/mutate-object-or-arrays-without-changing-original-source-in-javascript","title":"Mutate object or arrays without changing original source"}}},"pageContext":{}},"staticQueryHashes":["3649515864","63159454"]}